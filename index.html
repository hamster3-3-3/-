<!-- GitHub Pages 專用：雲端匯入（JSONP，不會被 CORS 擋） -->
<script>
  // 你的 Apps Script Web App（/exec）
  var DRIVE_LIST_API = 'https://script.google.com/macros/s/AKfycbyCo7YifdJrUnnaPrJkoscN9BKThY9jtNe0qxr0SHgmPk5yNVrKXQNp4n9v3PNJk7IF/exec';
  // Drive folder 固定在後端，前端不需要也不提供 folderId/token

  function jsonp(url, onDone) {
    var cb = '__cb_' + Date.now() + '_' + Math.floor(Math.random()*1e6);
    window[cb] = function(data) {
      try { onDone(null, data); } finally {
        try { delete window[cb]; } catch(e) { window[cb] = undefined; }
        if (script && script.parentNode) script.parentNode.removeChild(script);
      }
    };
    var script = document.createElement('script');
    script.src = url + (url.indexOf('?')>=0 ? '&' : '?') + 'action=list&callback=' + cb;
    script.onerror = function() {
      try { onDone(new Error('JSONP load failed')); } finally {
        try { delete window[cb]; } catch(e) { window[cb] = undefined; }
        if (script && script.parentNode) script.parentNode.removeChild(script);
      }
    };
    document.head.appendChild(script);
  }

  // 呼叫範例：點「從雲端匯入」時
  // jsonp(DRIVE_LIST_API, function(err, res) {
  //   if (err || !res || !res.ok) return alert('雲端清單載入失敗');
  //   console.log(res.items); // [{id, name, sizeBytes, updatedAt}, ...]
  // });
</script>
